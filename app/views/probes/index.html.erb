<h2>Dashboard</h2>

<ul class="probes">				

</ul>

<script>

$probes = {
	<% for probe in @probes %>
	'probe-<%= probe.id %>' :
	{
		'id'				: '<%= probe.id %>',
		'title'			: '<%= probe.title %>',
		'url'				: '<%= probe.url %>',		
	},
	<% end %>
}	
</script>

<script>

$widgets = {
	
	<% for widget in ::Widget.sorted %>
	'widget-<%= widget.id %>'	: 
	{
		'id'						: '<%= widget.id %>',
		'title' 				: '<%= widget.title %>',
		'args' 					: '<%= widget.args %>',
		<% if widget.uri %>
		'uri'						: '<%= widget.uri %>',
		<% end %>
		'template' 			: '<%= widget.template %>',
		<% if widget.probe %>
		'probe_id' 			: '<%= widget.probe_id %>',
		<% end %>
		<% if widget.thresholds.size > 0 %>
		'thresholds_attributes'	: [
		<% for threshold in widget.thresholds %>
			{ 'operator':'<%= raw threshold.operator %>', 'value': <%= threshold.value %>, 'alert':'<%= threshold.alert %>' },
		<% end %>
		],
		<% end %>
		'min'						: <%= widget.min %>,
		'max'						: <%= widget.max %>,
		'unit'					: '<%= widget.unit %>',
		'refresh_delay'	: <%= widget.refresh_delay %>,
	},
	<% end %>
}

</script>

<a href="<%= new_probe_path %>" class='button medium'><b> + New Probe</b></a>
<a href="<%= widgets_path %>" class='button medium'><b> Setup widgets</b></a>
